version: '3'

services:

    node1:
        build: .
        ports:
            - "8501:8500"
        volumes:
            - /mnt/btrfs1:/var/lib/buttervolume
            - ./..:/node
        privileged: true
        tty: true
        working_dir: /node
        networks:
            cluster:
                # eth0
                ipv4_address: 10.10.77.61

# TODO activate 4 nodes
    # node2:
    #     build: .
    #     ports:
    #         - "8502:8500"
    #     volumes:
    #         - /mnt/btrfs2:/var/lib/buttervolume
    #         - ./..:/node
    #     privileged: true
    #     tty: true
    #     working_dir: /node
    #     networks:
    #         cluster:
    #             # eth0
    #             ipv4_address: 10.10.77.62
    #
    # node3:
    #     build: .
    #     ports:
    #         - "8503:8500"
    #     volumes:
    #         - /mnt/btrfs3:/var/lib/buttervolume
    #         - ./..:/node
    #     privileged: true
    #     tty: true
    #     working_dir: /node
    #     networks:
    #         cluster:
    #             # eth0
    #             ipv4_address: 10.10.77.63
    #
    # node4:
    #     build: .
    #     ports:
    #         - "8504:8500"
    #     volumes:
    #         - /mnt/btrfs4:/var/lib/buttervolume
    #         - ./..:/node
    #     privileged: true
    #     tty: true
    #     working_dir: /node
    #     networks:
    #         cluster:
    #             # eth0
    #             ipv4_address: 10.10.77.64

networks:
    cluster:
        ipam:
            config:
                - subnet: 10.10.77.0/24
